{"version":3,"sources":["webpack:///./src/views/Member/settlement/index.vue","webpack:///./src/views/Member/settlement/index.vue?97fe","webpack:///./src/views/Member/settlement/index.vue?e1a3","webpack:///./src/api/order.js"],"names":["class","width","href","to","checkoutInfo","curAddress","receiver","contact","fullLocation","address","goods","i","key","id","src","picture","alt","name","attrsText","payPrice","count","totalPrice","totalPayPrice","summary","goodsCount","postFee","type","createOrders","setup","store","router","getOrder","result","console","log","value","userAddresses","reqData","deliveryTimeType","payType","buyerMessage","addressId","map","skuId","dispatch","push","__exports__","render","findCheckoutInfo","request","createOrder","order","findOrder"],"mappings":"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","file":"js/chunk-6733c512.15aa5794.js","sourcesContent":["<template>\r\n  <div class=\"xtx-pay-checkout-page\">\r\n    <div class=\"container\">\r\n      <XtxBread>\r\n        <XtxBreadItem to=\"/\">首页</XtxBreadItem>\r\n        <XtxBreadItem to=\"/cart\">购物车</XtxBreadItem>\r\n        <XtxBreadItem>填写订单</XtxBreadItem>\r\n      </XtxBread>\r\n      <div class=\"wrapper\" v-if=\"checkoutInfo\">\r\n        <!-- 收货地址 -->\r\n        <h3 class=\"box-title\">收货地址</h3>\r\n        <div class=\"box-body\">\r\n          <div class=\"address\">\r\n            <div class=\"text\">\r\n              <!-- 地址 有地址不显示提醒无地址显示 -->\r\n              <div class=\"none\" v-if=\"!curAddress\">\r\n                您需要先添加收货地址才可提交订单。\r\n              </div>\r\n              <ul v-if=\"curAddress\">\r\n                <li>\r\n                  <span>收<i />货<i />人：</span>{{ curAddress.receiver }}\r\n                </li>\r\n                <li><span>联系方式：</span>{{ curAddress.contact }}</li>\r\n                <li>\r\n                  <span>收货地址：</span\r\n                  >{{ curAddress.fullLocation + curAddress.address }}\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div class=\"action\">\r\n              <XtxButton class=\"btn\">切换地址</XtxButton>\r\n              <XtxButton class=\"btn\">添加地址</XtxButton>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- 商品信息 -->\r\n        <h3 class=\"box-title\">商品信息</h3>\r\n        <div class=\"box-body\">\r\n          <table class=\"goods\">\r\n            <thead>\r\n              <tr>\r\n                <th width=\"520\">商品信息</th>\r\n                <th width=\"170\">单价</th>\r\n                <th width=\"170\">数量</th>\r\n                <th width=\"170\">小计</th>\r\n                <th width=\"170\">实付</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <!-- 渲染的列表数据 -->\r\n              <tr v-for=\"i in checkoutInfo.goods\" :key=\"i.id\">\r\n                <td>\r\n                  <a href=\"javascript:;\" class=\"info\">\r\n                    <img :src=\"i.picture\" alt=\"\" />\r\n                    <div class=\"right\">\r\n                      <p>{{ i.name }}</p>\r\n                      <p>{{ i.attrsText }}</p>\r\n                    </div>\r\n                  </a>\r\n                </td>\r\n                <td>&yen;{{ i.payPrice }}</td>\r\n                <td>{{ i.count }}</td>\r\n                <td>&yen;{{ i.totalPrice }}</td>\r\n                <td>&yen;{{ i.totalPayPrice }}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <!-- 配送时间 -->\r\n        <h3 class=\"box-title\">配送时间</h3>\r\n        <div class=\"box-body\">\r\n          <a class=\"my-btn active\" href=\"javascript:;\"\r\n            >不限送货时间：周一至周日</a\r\n          >\r\n          <a class=\"my-btn\" href=\"javascript:;\">工作日送货：周一至周五</a>\r\n          <a class=\"my-btn\" href=\"javascript:;\">双休日、假日送货：周六至周日</a>\r\n        </div>\r\n        <!-- 支付方式 -->\r\n        <h3 class=\"box-title\">支付方式</h3>\r\n        <div class=\"box-body\">\r\n          <a class=\"my-btn active\" href=\"javascript:;\">在线支付</a>\r\n          <a class=\"my-btn\" href=\"javascript:;\">货到付款</a>\r\n          <span style=\"color: #999\">货到付款需付5元手续费</span>\r\n        </div>\r\n        <!-- 金额明细 -->\r\n        <h3 class=\"box-title\">金额明细</h3>\r\n        <!-- 多级渲染要判断 -->\r\n        <div class=\"box-body\" v-if=\"checkoutInfo.summary\">\r\n          <div class=\"total\">\r\n            <dl>\r\n              <dt>商品件数：</dt>\r\n              <dd>{{ checkoutInfo.summary.goodsCount }}件</dd>\r\n            </dl>\r\n            <dl>\r\n              <dt>商品总价：</dt>\r\n              <dd>¥{{ checkoutInfo.summary.totalPrice }}</dd>\r\n            </dl>\r\n            <dl>\r\n              <dt>运<i></i>费：</dt>\r\n              <dd>¥{{ checkoutInfo.summary.postFee }}</dd>\r\n            </dl>\r\n            <dl>\r\n              <dt>应付总额：</dt>\r\n              <dd class=\"price\">¥{{ checkoutInfo.summary.totalPayPrice }}</dd>\r\n            </dl>\r\n          </div>\r\n          <!-- 提交订单 -->\r\n          <div class=\"submit\">\r\n            <XtxButton type=\"primary\" @click=\"createOrders\">提交订单</XtxButton>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { createOrder as createOrderApi, findCheckoutInfo } from '@/api/order'\r\nimport { ref } from 'vue-demi'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\n// 提交订单api\r\nexport default {\r\n  name: 'XtxPayCheckoutPage',\r\n  setup () {\r\n    // 订单结算信息----购物车数据\r\n    const checkoutInfo = ref({})\r\n    // 地址\r\n    const curAddress = ref(null)\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    // 获取\r\n    const getOrder = async () => {\r\n      // { page = 1, pageSize = 10, orderState = 0 }\r\n      // 这里能拿到登录人的购物车选中数据是因为登录后在购物车里调用了接口直接操作了数据库\r\n      const { result } = await findCheckoutInfo()\r\n      console.log('订单数据', result)\r\n      checkoutInfo.value = result\r\n      curAddress.value = checkoutInfo.value.userAddresses[0]\r\n    }\r\n    getOrder()\r\n    // 填写的订单数据-----创建订单确认提交\r\n    const createOrders = async () => {\r\n      // 准备提交的数据对象\r\n      //       deliveryTimeType: 1, 配送时间类型，1为不限，2为工作日，3为双休或假日\r\n      //  payType: 1, 支付方式，1为在线支付，2为货到付款\r\n      //  buyerMessage: '', 买家留言\r\n      //  addressId: null, // 地址id\r\n      //  goods: [] // { skuId, count } 由所有商品的skuId 和 count字段组成的数组必须传\r\n      const reqData =\r\n      {\r\n        deliveryTimeType: 1, // 配送时间类型，1为不限，2为工作日，3为双休或假日\r\n        payType: 1, // 支付方式，1为在线支付，2为货到付款\r\n        buyerMessage: '', // 买家留言\r\n        addressId: '1429265915203031042', // 地址id\r\n        goods: [] // { skuId, count } 由所有商品的skuId 和 count字段组成的数组\r\n      }\r\n      // 处理goods数据\r\n      reqData.goods = checkoutInfo.value.goods.map(({ skuId, count }) => ({ skuId, count }))\r\n      const { result } = await createOrderApi(reqData)\r\n      // console.log('我', res)// ['1535011', '1127094', '1148091']\r\n      // 调接口传递已经选中的商品及参数对象---后台会帮我们把购物车中下单了的商品删除所以要刷新购物车----跳转到支付页面\r\n      store.dispatch('cart/getCartList')\r\n      router.push(`/pay?id=${result.id}`)\r\n    }\r\n    return {\r\n      checkoutInfo,\r\n      curAddress,\r\n      createOrders\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n.xtx-pay-checkout-page {\r\n  .wrapper {\r\n    background: #fff;\r\n    padding: 0 20px;\r\n    .box-title {\r\n      font-size: 16px;\r\n      font-weight: normal;\r\n      padding-left: 10px;\r\n      line-height: 70px;\r\n      border-bottom: 1px solid #f5f5f5;\r\n    }\r\n    .box-body {\r\n      padding: 20px 0;\r\n    }\r\n  }\r\n}\r\n.address {\r\n  border: 1px solid #f5f5f5;\r\n  display: flex;\r\n  align-items: center;\r\n  .text {\r\n    flex: 1;\r\n    min-height: 90px;\r\n    display: flex;\r\n    align-items: center;\r\n    .none {\r\n      line-height: 90px;\r\n      color: #999;\r\n      text-align: center;\r\n      width: 100%;\r\n    }\r\n    > ul {\r\n      flex: 1;\r\n      padding: 20px;\r\n      li {\r\n        line-height: 30px;\r\n        span {\r\n          color: #999;\r\n          margin-right: 5px;\r\n          > i {\r\n            width: 0.5em;\r\n            display: inline-block;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    > a {\r\n      color: @xtxColor;\r\n      width: 160px;\r\n      text-align: center;\r\n      height: 90px;\r\n      line-height: 90px;\r\n      border-right: 1px solid #f5f5f5;\r\n    }\r\n  }\r\n  .action {\r\n    width: 420px;\r\n    text-align: center;\r\n    .btn {\r\n      width: 140px;\r\n      height: 46px;\r\n      line-height: 44px;\r\n      font-size: 14px;\r\n      &:first-child {\r\n        margin-right: 10px;\r\n      }\r\n    }\r\n  }\r\n}\r\n.goods {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  border-spacing: 0;\r\n  .info {\r\n    display: flex;\r\n    text-align: left;\r\n    img {\r\n      width: 70px;\r\n      height: 70px;\r\n      margin-right: 20px;\r\n    }\r\n    .right {\r\n      line-height: 24px;\r\n      p {\r\n        &:last-child {\r\n          color: #999;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  tr {\r\n    th {\r\n      background: #f5f5f5;\r\n      font-weight: normal;\r\n    }\r\n    td,\r\n    th {\r\n      text-align: center;\r\n      padding: 20px;\r\n      border-bottom: 1px solid #f5f5f5;\r\n      &:first-child {\r\n        border-left: 1px solid #f5f5f5;\r\n      }\r\n      &:last-child {\r\n        border-right: 1px solid #f5f5f5;\r\n      }\r\n    }\r\n  }\r\n}\r\n.my-btn {\r\n  width: 228px;\r\n  height: 50px;\r\n  border: 1px solid #e4e4e4;\r\n  text-align: center;\r\n  line-height: 48px;\r\n  margin-right: 25px;\r\n  color: #666666;\r\n  display: inline-block;\r\n  &.active,\r\n  &:hover {\r\n    border-color: @xtxColor;\r\n  }\r\n}\r\n.total {\r\n  dl {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    line-height: 50px;\r\n    dt {\r\n      i {\r\n        display: inline-block;\r\n        width: 2em;\r\n      }\r\n    }\r\n    dd {\r\n      width: 240px;\r\n      text-align: right;\r\n      padding-right: 70px;\r\n      &.price {\r\n        font-size: 20px;\r\n        color: @priceColor;\r\n      }\r\n    }\r\n  }\r\n}\r\n.submit {\r\n  text-align: right;\r\n  padding: 60px;\r\n  border-top: 1px solid #f5f5f5;\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=17c04ee2&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=17c04ee2&scoped=true&lang=less\"\n\nimport exportComponent from \"F:\\\\ithiema\\\\黑马学习\\\\就业班\\\\07rabbit_test\\\\rabbitv0.0.1\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-17c04ee2\"]])\n\nexport default __exports__","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=17c04ee2&scoped=true&lang=less\"","import request from '@/utils/request'\r\n\r\n/**\r\n * 获取结算信息\r\n */\r\nexport const findCheckoutInfo = () => {\r\n  return request('/member/order/pre', 'get')\r\n}\r\n/**\r\n * 提交订单\r\n * @param {Object} order - 订单信息对象\r\n *  deliveryTimeType: 1, 配送时间类型，1为不限，2为工作日，3为双休或假日\r\n *  payType: 1, 支付方式，1为在线支付，2为货到付款\r\n *  buyerMessage: '', 买家留言\r\n *  addressId: null, // 地址id\r\n *  goods: [] // { skuId, count } 由所有商品的skuId 和 count字段组成的数组必须传\r\n */\r\nexport const createOrder = (order) => {\r\n  return request('/member/order', 'post', order)\r\n}\r\n\r\n/**\r\n * 获取订单详情\r\n * @param {String} id - 订单ID\r\n */\r\nexport const findOrder = (id) => {\r\n  return request('/member/order/' + id, 'get')\r\n}\r\n"],"sourceRoot":""}